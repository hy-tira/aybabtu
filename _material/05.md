---
title: 5. Järjestäminen
slug: osa5
permalink: /:title/
---

# 5. Järjestäminen

Pythonin funktio `sorted` palauttaa sille annetun listan järjestettynä:

```python
numbers = [4, 2, 1, 2, 5, 4, 5, 2]
print(sorted(numbers)) # [1, 2, 2, 2, 4, 4, 5, 5]
```

Funktion aikavaativuus on $$O(n \log n)$$, mikä tarkoittaa, että funktio toimii tehokkaasti myös suurilla listoilla.

Tässä luvussa tutustumme siihen, miten tehokasta järjestämistä voidaan käyttää algoritmien osana. Tutustumme myös järjestämisen taustalla olevaan teoriaan sekä järjestämiseen muissa ohjelmointikielissä.

## Esimerkki: Montako eri lukua?

<div class="note" markdown="1">

Annettuna on lista lukuja. Montako eri lukua listalla on?

Esimerkiksi kun lista on $$[3,1,2,1,5,2,2,3]$$, haluttu vastaus on $$4$$, koska eri luvut ovat $$1$$, $$2$$, $$3$$ ja $$5$$.

</div>

Ratkaisimme tämän tehtävän jo aiemmin tehokkaasti hajautuksen avulla, mutta ratkaistaan tehtävä nyt uudestaan järjestämisen avulla.

Ideana on järjestää ensin listan sisältö, minkä jälkeen yhtä suuret luvut ovat vierekkäin. Tämän jälkeen käymme läpi listan vasemmalta oikealle ja vertailemme joka lukua sitä edelliseen lukuun. Aina kun luku muuttuu edellisestä luvusta, on löytynyt uusi luku ja tulos kasvaa yhdellä.

Seuraava funktio toteuttaa algoritmin:

```python
def count_distinct(numbers):
    numbers = sorted(numbers)    
    result = 1
    for i in range(1, n):
        if numbers[i] != numbers[i - 1]:
            result += 1
    return result
```

Algoritmissa listan järjestäminen vie aikaa $$O(n \log n)$$ ja sen jälkeen listan läpikäynti vie aikaa $$O(n)$$. Niinpä algoritmin aikavaativuus on $$O(n \log n)$$.

Huomaa, että voisimme käyttää funktion alussa myös listan metodia `sort`:

```python
def count_distinct(numbers):
    numbers.sort()
    ...
```

Tässä on kuitenkin ongelmana, että metodi `sort` järjestää parametrina annetun listan ja metodin `sort` vaikutus heijastuu myös funktion `count_distinct` kutsukohtaan. Tämä ei ole toivottava ilmiö, koska funktion ei pitäisi muuttaa listan sisältöä. Seuraavat koodit havainnollistavat asiaa:


{: .code-title }
Käytössä `sort`
```python
numbers = [1, 2, 3, 1, 2, 3]
print(count_distinct(numbers)) # 3
print(numbers) # [1, 1, 2, 2, 3, 3]
```

{: .code-title }
Käytössä `sorted`
```python
numbers = [1, 2, 3, 1, 2, 3]
print(count_distinct(numbers)) # 3
print(numbers) # [1, 2, 3, 1, 2, 3]
```

Kun käytössä on metodi `sort`, funktion `count_distinct` kutsuminen järjestää sivuvaikutuksena listan `numbers`. Kun käytössä on funktio `sorted`, lista `numbers` ei muutu, koska funktio `sorted` luo uuden järjestetyn listan.

## Hajautus vs. järjestäminen

Monessa tehtävässä on kaksi mahdollisuutta tehokkaan algoritmin toteuttamiseen: hajautus tai järjestäminen. Verrataan seuraavaksi aiemman hajautusta käyttävän algoritmin ja äskeisen järjestämistä käyttävän algoritmin tehokkuutta.

{: .code-title }
Algoritmi 1 (hajautus)
```python
def count_distinct(numbers):
    seen = set()
    for x in numbers:
        seen.add(x)
    return len(seen)
```

{: .code-title }
Algoritmi 2 (järjestäminen)
```python
def count_distinct(numbers):
    numbers = sorted(numbers)    
    result = 1
    for i in range(1, n):
        if numbers[i] != numbers[i - 1]:
            result += 1
    return result
```

| Listan koko `n` | Algoritmi 1 | Algoritmi 2
| --- | --- | --- | 
| 1000 | 0.09 s | 0.00 s |
| 10000 | 8.75 s | 0.00 s |
| 100000 | -- | 0.01 s |
| 1000000 | -- | 0.27 s |

## Esimerkki: Pienin ero

<div class="note" markdown="1">

Annettuna on lista lukuja. Mikä on pienin ero kahden luvun välillä?

Esimerkiksi kun lista on $$[5,1,9,4,7]$$, haluttu vastaus on $$1$$, koska pienin ero on lukujen $$4$$ ja $$5$$ välillä.

</div>

```python
def min_distance(numbers):
    numbers = sorted(numbers)
    n = len(numbers)
    result = numbers[1] - numbers[0]
    for i in range(1, n):
        result = min(result, numbers[i] - numbers[i - 1])
    return result
```

## Esimerkki: Ravintola

<div class="note" markdown="1">

Ravintolassa käy päivän aikana $$n$$ asiakasta ja tiedät, milloin kukin asiakas saapuu ja lähtee. Jos asiakas lähtee samalla hetkellä kuin toinen asiakas saapuu, tulkintana on, että he ovat yhtä aikaa ravintolassa. Tehtäväsi on selvittää suurin määrä asiakkaita, jotka ovat yhtä aikaa ravintolassa.

Tarkastellaan esimerkkinä seuraavaa tilannetta:

Asiakas | Saapumisaika | Lähtöaika
--- | ---
#1 | 6 | 8
#2 | 3 | 7
#3 | 6 | 9
#4 | 1 | 5
#5 | 2 | 8

Tässä tapauksessa suurin määrä asiakkaita on 4 asiakasta: asiakkaat #1, #2, #3 ja #5 ovat yhtä aikaa ravintolassa aikavälillä 6–7.

</div>

```python
def max_customers(arrivals, departures):
    events = []
    for time in arrivals:
        events.append((time, 1))
    for time in departures:
        events.append((time, 2))
        
    events = sorted(events)
    
    counter = 0
    result = 0
    for event in events:
        if event[1] == 1:
            counter += 1
        if event[1] == 2:
            counter -= 1
        result = max(result, counter)
        
    return result
```
